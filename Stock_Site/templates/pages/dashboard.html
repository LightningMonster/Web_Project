<!DOCTYPE
html >
  <html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - StockStats</title>
    <style>
        /* General Styles */
        /* General Styles */
body {
    font-family: 'Times New Roman', sans-serif;
    margin: 0;
    padding: 0;
    background-color: #121212;
    color: #f4fafa;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    transition: background-color 0.3s, color 0.3s;
}

body.light-mode {
    background-color: #f4f4f9;
    color: #620770;
}

a {
    color: #ffffff;
    text-decoration: none;
    transition: color 0.3s;
}

body.light-mode a {
    color: #6c0486;
}

a:hover {
    color: #00cccc;
}

body.light-mode a:hover {
    color: #040404;
}

/* Top Navbar */
.top-navbar {
    background-color: #000000;
    padding: 0px 16px; /* Remove padding from top and bottom */
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid rgba(0, 255, 255, 0.2);
    height: 50px; /* Set a fixed height for the navbar */
}

body.light-mode .top-navbar {
    background-color: #ffffff;
    border-bottom: 1px solid #ddd;
}

.profile-section {
    display: flex;
    align-items: center;
    gap: 8px; /* Reduce the gap between elements */
}

.profile-image {
    width: 30px; /* Reduce the size of the profile image */
    height: 30px;
    border-radius: 50%;
    background-color: #72098f;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 14px; /* Adjust font size */
}

.theme-toggle {
    background-color: #72098f;
    color: #fff;
    border: none;
    border-radius: 4px;
    padding: 6px 12px; /* Reduce padding */
    cursor: pointer;
    transition: background-color 0.2s;
    font-size: 14px; /* Adjust font size */
}

.theme-toggle:hover {
    background-color: #852d82;
}

/* Main Content Layout */
.content-wrapper {
    display: flex;
    flex: 1;
}

/* Sidebar */
.sidebar {
    width: 250px;
    background-color: #000000;
    padding: 20px;
    border-right: 1px solid rgba(0, 255, 255, 0.2);
    transition: background-color 0.3s, border-color 0.3s;
}

body.light-mode .sidebar {
    background-color: #ffffff;
    border-right: 1px solid #ddd;
}

.sidebar h1 {
    margin: 0 0 20px 0;
    font-size: 1.5em;
}

.sidebar nav ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.sidebar nav ul li {
    margin-bottom: 10px;
}

/* Main Content */
.main-container {
    flex: 1;
    padding: 10px 20px; /* Reduced padding from top */
    display: flex;
    flex-direction: column;
}

.content {
    display: flex;
    gap: 20px;
    flex: 1;
}

.watchlist-section, .stock-section {
    background-color: #1e1e1e;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid rgba(0, 255, 255, 0.2);
    flex: 1;
    transition: background-color 0.3s, border-color 0.3s;
}

body.light-mode .watchlist-section, body.light-mode .stock-section {
    background-color: #ffffff;
    border: 1px solid #ddd;
}

.watchlist-section h2, .stock-section h3 {
    margin-top: 0;
    color: #fdfdfd;
    transition: color 0.3s;
}

body.light-mode .watchlist-section h2, body.light-mode .stock-section h3 {
    color: #6f058f;
}

.watchlist-section ul, .stock-section ul {
    list-style: none;
    padding: 0;
}

.watchlist-section li, .stock-section li {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 0;
    border-bottom: 1px solid rgba(0, 255, 255, 0.1);
    transition: border-color 0.3s;
}

body.light-mode .watchlist-section li, body.light-mode .stock-section li {
    border-bottom: 1px solid #ddd;
}

.watchlist-section li:last-child, .stock-section li:last-child {
    border-bottom: none;
}

.plus-button, .minus-button {
    background-color: #72098f;
    color: #fff;
    border: none;
    border-radius: 4px;
    padding: 5px 10px;
    cursor: pointer;
    transition: background-color 0.2s;
}

.plus-button:hover, .minus-button:hover {
    background-color: #005555;
}

.scrollable-card {
    max-height: 300px;
    overflow-y: auto;
    border: 1px solid rgba(0, 255, 255, 0.2);
    border-radius: 4px;
    padding: 10px;
    transition: border-color 0.3s;
}

body.light-mode .scrollable-card {
    border: 1px solid #ddd;
}

/* Forms */
form {
    margin-bottom: 20px;
}

label {
    display: block;
    margin-bottom: 5px;
    color: #ffffff;
    transition: color 0.3s;
}

body.light-mode label {
    color: #6f0589;
}

input[type="text"] {
    width: 100%;
    padding: 8px;
    margin-bottom: 10px;
    background-color: #2d2d2d;
    border: 1px solid rgba(0, 255, 255, 0.3);
    border-radius: 4px;
    color: #ffffff;
    transition: background-color 0.3s, border-color 0.3s, color 0.3s;
}

body.light-mode input[type="text"] {
    background-color: #f4f4f9;
    border: 1px solid #ddd;
    color: #000000;
}

button[type="submit"] {
    background-color: #72098f;
    color: #fff;
    border: none;
    border-radius: 4px;
    padding: 8px 16px;
    cursor: pointer;
    transition: background-color 0.2s;
}

button[type="submit"]:hover {
    background-color: #f0f4f4;
}

/* Footer */
footer {
    background-color: #1e1e1e;
    padding: 20px;
    text-align: center;
    border-top: 1px solid rgba(0, 255, 255, 0.2);
    transition: background-color 0.3s, border-color 0.3s;
}

body.light-mode footer {
    background-color: #ffffff;
    border-top: 1px solid #ddd;
}

footer p {
    margin: 0;
    color: #ffffff;
    transition: color 0.3s;
}

body.light-mode footer p {
    color: #333;
}
    </style>    
</head>
<body>
    <!-- Top Navbar -->
    <nav class="top-navbar">
        <h1>StockStats Dashboard</h1>
        <div class="profile-section">
            <div class="profile-image">
                {% if user.is_authenticated %}
                    {{ user.first_name|first|upper }}{{ user.last_name|first|upper }}
                {% else %}
                    G
                {% endif %}
            </div>
            <span>
                {% if user.is_authenticated %}
                    {{ user.first_name }} {{ user.last_name }}
                {% else %}
                    Guest
                {% endif %}
            </span>
            <button class="theme-toggle" id="theme-toggle">ðŸŒ™ Dark Mode</button>
        </div>
    </nav>

    <div class="content-wrapper">
        <!-- Sidebar -->
        <div class="sidebar">
            <nav>
                <ul>
                    <li><a href="{% url 'home2' %}">Home</a></li>
                    <li><a href="{% url 'calculators' %}">Calculators</a></li>
                    <li><a href="{% url 'dashboard' %}">Dashboard</a></li>
                    <li><a href="#">Tools</a></li>
                    {% if user.is_authenticated %}
                        <li><a href="{% url 'logout' %}" id="logout-btn">Logout</a></li>
                    {% else %}
                        <li><a href="{% url 'login' %}">Login</a></li>
                    {% endif %}
                </ul>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="main-container">
            <div class="content">
                <!-- Watchlist Section -->
                <div class="watchlist-section">
                    <h2>Your Watchlist</h2>
                    <ul id="watchlist">
                        {% for item in watchlist %}
                        <li>
                            <button class="minus-button" onclick="removeStockFromWatchlist('{{ item.stock_data__stock_symbol }}')">-</button>
                            <a class="stock-link" href="{% url 'stock_detail' item.stock_data__stock_symbol %}">
                                {{ item.stock_data__stock_symbol }} - {{ item.latest_date|date:"M. d, Y" }}
                            </a>
                        </li>
                        {% empty %}
                        <li>No stocks in your watchlist.</li>
                        {% endfor %}
                    </ul>
                </div>

                <!-- Stock Section -->
                <div class="stock-section">
                    <h3>Add a Stock to Watchlist</h3>
                    <form method="post" action="{% url 'add_to_watchlist' %}">
                        {% csrf_token %}
                        <label for="stock_symbol">Stock Symbol:</label>
                        <input type="text" id="stock_symbol" name="stock_symbol" required>
                        <button type="submit">Add</button>
                    </form>

                    <h3>Available Stocks</h3>
                    <div class="scrollable-card">
                        <ul>
                            {% for stock in available_stocks %}
                            <li>
                                <button class="plus-button" onclick="addStockToWatchlist('{{ stock.stock_symbol }}')">+</button>
                                <a class="stock-link" href="{% url 'stock_detail' stock.stock_symbol %}">
                                    {{ stock.stock_symbol }}
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer>
                <p>&copy; 2025 Indian Stock Analysis. All rights reserved.</p>
            </footer>
        </div>
    </div>

    <script>
        // Function to add stock to watchlist
        function addStockToWatchlist(stockSymbol) {
            fetch("{% url 'add_to_watchlist' %}", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: `stock_symbol=${stockSymbol}`
            })
            .then(response => {
                if (response.ok) {
                    window.location.reload(); // Reload the page to reflect the changes
                } else {
                    alert('Failed to add stock to watchlist.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }

        // Function to remove stock from watchlist
        function removeStockFromWatchlist(stockSymbol) {
            fetch("{% url 'remove_from_watchlist' %}", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: `stock_symbol=${stockSymbol}`
            })
            .then(response => {
                if (response.ok) {
                    window.location.reload(); // Reload the page to reflect the changes
                } else {
                    alert('Failed to remove stock from watchlist.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }

        // Dark/Light Mode Toggle
        const themeToggle = document.getElementById('theme-toggle');
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('light-mode');
            themeToggle.textContent = document.body.classList.contains('light-mode') ? 'ðŸŒ™ Dark Mode' : 'ðŸŒž Light Mode';
        });
    </script>
</body>
</html>

